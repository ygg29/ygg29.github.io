---
title: RSA的数学原理
tags:
  - 算法
categories:
  - 软件开发
date: 2019-08-23 14:16:48
---

### 发展历史

**密码学**的历史大致可以追溯到两千年前，相传古罗马名将凯撒大帝为了防止敌方截获情报，用密码传送情报。凯撒的做法很简单，就是对二十几个罗马字母建立一张对应表。这样，如果不知道密码本，即使截获一段信息也看不懂。

<!-- more -->

从凯撒大帝时代到上世纪70年代这段很长的时间里，密码学的发展非常的缓慢，因为设计者基本上靠经验，加密解密使用同一套算法，没有运用**数学原理**。

#### 近代发展

- 在1976年以前，所有的加密方法都是同一种模式：**加密**、**解密**使用**同一种**算法。在交互数据的时候，彼此通信的双方就必须将规则告诉对方，否则没法解密。那么加密和解密的规则（简称**密钥**），它保护就显得尤其重要。传递密钥就成为了最大的隐患。这种加密方式被成为**对称加密算法（**symmetric encryption algorithm**）**。

- 1976年，两位美国计算机学家 **迪菲**（W.Diffie）、**赫尔曼**（ M.Hellman ） 提出了一种崭新构思，可以在不直接传递密钥的情况下，完成密钥交换。这被称为**“迪菲赫尔曼密钥交换”**算法。开创了密码学研究的新方向。

- 1977年三位麻省理工学院的数学家 [罗纳德](https://baike.baidu.com/item/罗纳德·李维斯特/700199)[·](https://baike.baidu.com/item/罗纳德·李维斯特/700199)[李维斯特](https://baike.baidu.com/item/罗纳德·李维斯特/700199)（Ron Rivest）、[阿迪](https://baike.baidu.com/item/阿迪·萨莫尔)[·](https://baike.baidu.com/item/阿迪·萨莫尔)[萨莫尔](https://baike.baidu.com/item/阿迪·萨莫尔)（Adi Shamir）和[伦纳德](https://baike.baidu.com/item/伦纳德·阿德曼/12575612)[·](https://baike.baidu.com/item/伦纳德·阿德曼/12575612)[阿德曼](https://baike.baidu.com/item/伦纳德·阿德曼/12575612)（Leonard Adleman）一起设计了一种算法，可以实现非对称加密。这个算法用他们三个人的名字命名，叫做[RSA算法](http://zh.wikipedia.org/zh-cn/RSA加密算法)。

### 数学原理与概念

> 上世纪70年代产生的一种加密算法。其加密方式比较特殊，需要两个密钥：公开密钥简称**公钥（publickey）**和私有密钥简称**私钥（privatekey）**。**公钥加密，私钥解密；私钥加密，公钥解密**。
>
> 这种算法非常可靠，密钥越长，破解难度越高。根据公开资料，目前被破解的最长 RSA密钥是 768 个二进制位。因此可以认为，1024 位的 RSA 密钥基本安全，2048 位的密钥极其安全。

这个加密算法就是伟大的RSA。

#### 离散对数问题

RSA 算法的基础建立在[离散对数](https://baike.baidu.com/item/%E7%A6%BB%E6%95%A3%E5%AF%B9%E6%95%B0/4538780)问题求解的复杂度上，即加密容易而破解困难。如：

对于`g^N mod P = A` 的等式来说，正向求值是很容易的，但是想反向求出 `N` 则非常困难，而且困难程度随着 P 的增大指数上升。

#### 原根

[原根](https://baike.baidu.com/item/%E5%8E%9F%E6%A0%B9)是数论中一个非常重要的概念，它在密码学中有着很广泛的应用。原根从直观上非常好理解，简单来说，假设一个数g是P的原根，那么g^i ~mod~ P的结果两两不同，且有 1<g<P，0<i<P，归根到底就是g^(P-1) = 1 (mod P)当且仅当指数为P-1的时候成立.(这里P是素数)。

如 ：2^1^ ~mod~ 5 ≡ 2；2^2^ ~mod~ 5 ≡ 4； 2^3^ ~mod~ 5 ≡ 3； 2^3^ ~mod~ 5 ≡ 1；

可见指数取值为{ 1、2、3、4} 时，结果取值也正好为 {1、2、3、4}

则称 **2 为 5 的原根**。

#### 欧拉函数

思考：**<font color=green>任意给定正整数n，请问在小于等于n的正整数之中，有多少个与n构成互质关系？</font>**

上述问题的求解函数及为**欧拉函数**，记为**φ(n)**。

欧拉函数有如下特点：

- 当n是质数的时候，φ(n)=n-1。
- 如果n可以分解成两个互质的整数之积，如`n=A*B`则：`φ(A*B)=φ(A)φ(B)`

#### 欧拉定理

定理：**<font color=green>如果两个正整数m和n互质，那么m的φ(n)次方减去1，可以被n整除。</font>**

记为：

**<font color=red>m^φ(n)^ ~mod~ n ≡ 1</font>**

#### 模反元素

定理：**<font color=green>如果两个正整数e和x互质，那么一定可以找到整数d，使得 ed-1 被 x 整除。</font>**

那么d就是e对于x的**“模反元素”**

### 公式推导

<font color=#be7148>根据欧拉定理</font>

<font color=#be7148>对于 **m<sup>φ(n)</sup> <sub>mod</sub> n ≡ 1** 且  **gcd(m, n) = 1**</font>

<font color=#be7148>有 **m <sup>φ(n)*k</sup><sub>mod</sub>n≡1^k^​**</font>

<font color=#be7148>两边同乘以 m</font>

<font color=#be7148>则 **m<sup>k*φ(n)+1</sup> <sub>mod</sub> n ≡ m**  ①</font>

<font color=#be7148>根据模反元素</font>

<font color=#be7148>**e*d <sub>mod</sub> x ≡ 1​**</font>

<font color=#be7148>则存在 **k** 使 **e*d ≡ k\*x + 1**  ②</font>

<font color=#be7148>结合 ①、 ②则有</font>

$m^{e*d}\bmod n \equiv m$

<font color=red size=5>**$m^{e*d}\bmod n \equiv m$**</font>

$m^{e*d} _{mod} n \equiv m$



$$

上式即为非对称加密的基本公式，此处有四个参数，m和e、n和d 分别组成对应的公钥和私钥。

